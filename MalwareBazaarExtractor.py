import logging
import os

from malware_extractor import MalwareExtractor


logger = logging.getLogger(__name__)


class MalwareBazaarExtractor(MalwareExtractor):
    def process_input(self):
        # files in here are in subdirectories named for each zip file, so 2021-03-30.zip/2021-03-30.zip.zip
        # yes, I screwed that up, but now I've got over a year of that data in that format, and it doesn't
        # matter from an analysis point of view. So I'm going to accept them as-is.
        self.copy_files()


if __name__ == "__main__":
    logger.info("Malware Bazaar Extractor starting up.")
    # assume mounted path is path to directory of files, so skipping any need for sub-directories.
    collector_path = os.environ.get("COLLECTOR_PATH")
    extractor_path = os.environ.get("EXTRACTOR_PATH")
    extractor = MalwareBazaarExtractor(collector_path, extractor_path)
    extractor.process_input()
    logger.info("Malware Bazaar Extractor completed.")
